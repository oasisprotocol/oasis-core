go/roothahs: Optimize runtime history reindex

During runtime history reindex, we batch 1000 writes at the same time,
resulting in 2x speed-up of history reindex.
